CREATE TABLE Users(
	Id BIGINT PRIMARY KEY IDENTITY NOT NULL,
	Username VARCHAR(30) UNIQUE NOT NULL,
	[Password] VARCHAR(26) NOT NULL,
	ProfilePicture VARBINARY(MAX) CHECK(DATALENGTH(ProfilePicture) <= 900 * 1024),
	LastLoginTime DATETIME2 NOT NULL,
	IsDeleted BIT NOT NULL CHECK(IsDeleted = 'true' OR IsDeleted = 'false')
)

ALTER TABLE Users
	DROP CONSTRAINT [PK__Users__3214EC072D629B6F]

ALTER TABLE Users
	ADD CONSTRAINT PK_Users_CompositeIdUsername
	PRIMARY KEY(Id, Username)

ALTER TABLE Users
	ADD CONSTRAINT CK_Users_Password_Length CHECK(LEN([Password]) >= 5)

ALTER TABLE Users
	ADD CONSTRAINT DF_Users_LastLoginTime DEFAULT GETDATE() FOR LastLoginTime

ALTER TABLE Users
	DROP CONSTRAINT PK_Users_CompositeIdUsername

ALTER TABLE Users
	ADD CONSTRAINT PK_Users_Id
	PRIMARY KEY(Id)

ALTER TABLE Users
	ADD CONSTRAINT CK_UsernameLength CHECK(LEN(Username) >= 3)
